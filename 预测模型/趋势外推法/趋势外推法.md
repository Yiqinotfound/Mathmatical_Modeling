趋势外推法
   

         

## 1. 模型概览




### 1.1 学科分属




 连续型预测时间序列模型



 趋势外推法又称为趋势延伸法，它是根据预测变量的历史时间序列揭示出的变动趋势外推将来，以确定预测值的一种预测方法。趋势外推法通常用于预测对象的发展规律是呈渐进式的变化，而不是跳跃式的变化，并且能够找到一个合适函数曲线反映预测对象变化趋势的情况。



 趋势外推法的基本理论是：决定事物过去发展的因素，在很大程度上也决定该事物未来的发展，其变化，不会太大；事物发展过程一般都是渐进式的变化，而不是跳跃式的变化掌握事物的发展规律，依据这种规律推导，就可以预测出它的未来趋势和状态。




### 1.2 历史发展




 趋势外推法首先由**R.赖恩**（Rhyne）用于科技预测。他认为，应用趋势外推法进行预测，主要包括以下6个步骤：



 （1）选择预测参数；



 （2）收集必要的数据；



 （3）拟合曲线；



 （4）趋势外推；



 （5）预测说明；



 （6）研究预测结果在制订规划和决策中的应用。



 趋势外推法是在对研究对象过去和现在的发展作了全面分析之后，利用某种模型描述某一参数的变化规律，然后以此规律进行外推。为了拟合数据点，实际中最常用的是一些比较简单的函数模型，如线性模型、指数曲线、生长曲线、包络曲线等。




## 2. 模型介绍




### 2.1  具体模型介绍




 (阐述该模型的机理、数学推导等。)



 * 基本模型：**指数曲线法** 



 



 * 原理：  一般来说，技术的进步和生产的增长，在其**未达饱和之前的新生时期**是遵循指数曲线增长规律的，因此可以用指数曲线对发展中的事物进行预测。 



 



 * 数学表达式：$y=y_{0}e^{kt}$​ ————（$y_{0}$ 和 $k$​​ 是参数，由历史数据利用线性回归方法求得）

 * 参数具体求解方法：



 对上述表达式两侧取对数可得：$lny=lny_{0}+Kt$​



 令：$Y=lny, A=lny_{0}$​



 则：$Y=A+Kt$​



 其中$A,K$可以用最小二乘法求得。










### 2.2  模型变种




 该模型有如下变种：



 | 常用模型                  | 曲线变化规律                                                 |

 | ------------------------- | ------------------------------------------------------------ |

 | 修正指数曲线法            | 初期**增长迅速**，随后**增长率逐渐降低**，最终**极限趋于某个稳定值** |

 | Compertz 曲线             | 初期**增长缓慢**，随后逐渐**加快**，达到一定程度后增长率**又下降** |

 | Logistic 曲线（生长曲线） | 初期**增长缓慢**，随后突然**加快**，最后增长率**又下降**     |



 Compertz 曲线和 Logistic 曲线（生长曲线）形状大致相似，但公式适用条件有所不同。




#### 2.21 修正指数曲线法




 * 数学表达式：$y_{t}=K+ab^{t}$​————（$K、a、b$是参数，由历史数据确定）



 由曲线变化规律可知：极限为$K$



 * 适用前提：给定数据的逐期增长量的比率接近某一常数b，即：

 $$

 \frac{y_{t+1}-y_{t}}{y_{t}-y_{t-1}}\approx b

 $$



 * 参数具体求解方法：



   ##### （1）已知K值



   采用最小二乘法求a、b，具体方法同指数曲线法参数具体求解方法。



   ##### （2）不预知K值



   **三和法**求解：



   把时间序列的n个观察值等分为三部分，每部分有m期，即n=3m。



   第一部分：$y_{1},y_{2},…,y_{m}$​



   第二部分：$y_{m+1},y_{m+2},…,y_{2m}$



   第三部分：$y_{2m+1},y_{2m+2},…,y_{3m}$



   ​	令每部分的趋势值之和等于相应的观察值之和，由此给出参数估计值。三和法步骤如下：



  ​	记观察值的各部分之和：$S_{1}=\sum^{m}_{t=1}{y_{t}},S_{2}=\sum^{2m}_{t=m+1}{y_{t}},S_{3}=\sum^{3m}_{t=2m+1}{y_{t}}$​



  且

   $$

   S_{1}=\sum^{m}_{t=1}{y_{t}}=\sum^{m}_{t=1}{(K+ab^{t})}=mK+ab(1+b+b^{2}+…+b^{m-1})

   $$

   $$

   S_{2}=\sum^{2m}_{t=m+1}{y_{t}}=\sum^{2m}_{t=m+1}{(K+ab^{t})}=mK+ab^{m+1}(1+b+b^{2}+…+b^{m-1})

   $$

   $$

   S_{3}=\sum^{3m}_{t=2m+1}{y_{t}}=\sum^{3m}_{t=2m+1}{(K+ab^{t})}=mK+ab^{2m+1}(1+b+b^{2}+…+b^{m-1}) \tag{1}

   $$

   由于

   $$

   (1+b+b^{2}+…+b^{m-1})(b-1)=b^{m}-1

   $$

   (1)式可变化为：

   $$

   S_{1} =mK+ab(1+b+b^{2}+…+b^{m-1})=mK+ab\frac{b^{m-1}}{b-1}

   $$

   $$

   S_{2} =mK+ab^{m+1}(1+b+b^{2}+…+b^{m-1})=mK+ab^{m+1}\frac{b^{m-1}}{b-1}

   $$

   $$

   S_{3} =mK+ab^{2m+1}(1+b+b^{2}+…+b^{m-1})=mK+ab^{2m+1}\frac{b^{m-1}}{b-1}\tag{2}

   $$

   由（2）式，解得：

   $$

   b = (\frac{S_{3}-S_{2}}{S_{2}-S_{1}})^{\frac{1}{m}}

   $$

   $$

   a = (S_{2}-S_{1})\frac{b-1}{b(b^{m}-1)^{2}}

   $$

   $$

   K = \frac{1}{m}[S_{1}-\frac{ab(b^{m}-1)}{b-1}]

   $$

   至此三个参数全部确定。



   



 * 例1：根据统计资料，某厂收音机连续 15 年的销售量如表 11。 试用修正指数曲线预测 1986 年的销售量。

















 * 计算的MATLAB程序如下：



   ```matlab

   function chanliang 

   clc,clear 

   global a b k 

   load xsh.txt %原始数据存放在纯文本文件 xsh.txt 中 

   yt=xsh; n=length(yt);m=n/3 

   cf=diff(yt); 

   for i=1:n-2     

       bzh(i)=cf(i+1)/cf(i); 

   end 

   range=minmax(bzh) 

   s1=sum(yt(1:m)), s2=sum(yt(m+1:2*m)), s3=sum(yt(2*m+1:end)) 

   b=((s3-s2)/(s2-s1))^(1/m) a=(s2-s1)*(b-1)/(b*(b^m-1)^2) 

   k=(s1-a*b*(b^m-1)/(b-1))/m 

   y=yuce(1:18) 

   %************************************ 

   %定义预测函数 

   %************************************ 

   function 

   y=yuce(t) 

   global a b k 

   y=k+a*b.^t;  

   ```






#### 2.22 Logistic 曲线




 Logistic曲线是一种常见的S形函数，它是皮埃尔·弗朗索瓦·韦吕勒在1844或1845年在研究它与人口增长的关系时命名的。广义Logistic曲线可以模仿一些情况人口增长（P）的S形曲线。起初阶段大致是指数增长；然后随着开始变得饱和，增加变慢；最后，达到成熟时增加停止。



 * 数学表达式：










 * 适用前提：

 







 * 参数具体求解方法：












   例2：（续例 1）  根据表 11 的数据，试确定收音机销售量的 Logistic 曲线方程， 求出各年收音机销售量的趋势值，并预测 1986 年的销售量。




![avatar](logistic解.png)




 *  计算的 MATLAB 程序如下：



   ```matlab

   function chanliang3 

   clc,clear 

   global a b k 

   load xsh.txt %原始数据存放在纯文本文件 xsh.txt 中 

   yt=1./xsh; n=length(yt);m=n/3; 

   s1=sum(yt(1:m)), s2=sum(yt(m+1:2*m)), s3=sum(yt(2*m+1:end)) 

   b=((s3-s2)/(s2-s1))^(1/m) 

   a=(s2-s1)*(b-1)/(b*(b^m-1)^2) 

   k=(s1-a*b*(b^m-1)/(b-1))/m 

   y=yuce(1:18) 

   %************************************ %定义预测函数 %************************************ function y=yuce(t); 

   global a b k 

   y=1./(k+a*b.^t); 

   ```




#### 2.23 Compertz 曲线




 * 数学表达式











 * 适用前提








 * 参数具体求解方法






![](img_0.png)








 * 例3：（续例1）根据表 11 的数据，试确定收音机销售量的 Gompertz 曲线方程， 求出各年收音机销售量的趋势值，并预测 1986 年的销售量。




![avatar](compertz解.png)







 * 计算的 MATLAB 程序如下：



 ```matlab

 function chanliang2 

 clc,clear 

 global a b k 

 load xsh.txt %原始数据存放在纯文本文件 xsh.txt 中 

 yt=log(xsh); n=length(yt);m=n/3; 

 s1=sum(yt(1:m)), s2=sum(yt(m+1:2*m)), s3=sum(yt(2*m+1:end)) 

 b=((s3-s2)/(s2-s1))^(1/m) 

 a=(s2-s1)*(b-1)/(b*(b^m-1)^2) 

 k=(s1-a*b*(b^m-1)/(b-1))/m a=exp(a) 

 k=exp(k) 

 y=yuce(1:18) 

 %************************************ %定义预测函数 %************************************ function y=yuce(t); 

 global a b k 

 y=k*a.^(b.^t); 

 ```




## 3. 模型应用




### 3.1 常见应用场景




 经济预测、生物群体增长（人口预测）、分析新技术可能出现的时机、用于验证规划中制订的技术参数指标是否合理，为未来产品设计的功能特性参数提供评价依据。






### 3.2 数学建模竞赛应用




 2006年美赛C题传染病模型  




## 4.软件/程序介绍




### 4.1 模拟介绍




 Python/MATLAB/C++……（MATLAB大写，Python首字母大写）



 具体的代码在上文有举例说明。




### 4.2 其他特殊软件实现




 如 Lingo、CPlex……







## 修改记录




- 2021-08-17，陈金源，郭凌霄，王凯佳修改

- 2021-08-10，郑鸿晓更新模板

- 2021-08-04，张嘉乐建立模板



